<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="styles.css">
  <title>Ninja Chat</title>
</head>
<body>

  <!-- container & title -->
  <div class="main-container container my-4 p-2">
    <div class="my-4 text-center">
      <h1 class="my-4 text-center">Ninja Chat</h1>
      <!-- buttons for chatrooms -->
      <div class="my-2">Choose a chatroom:</div>
      <div class="container chat-rooms mb-3 text-center">
        <button class="chat-room btn my-2" id="general">#general</button>
        <button class="chat-room btn my-2" id="gaming">#gaming</button>
        <button class="chat-room btn my-2" id="music">#music</button>
        <button class="chat-room btn my-2" id="movies">#movies</button>
      </div>
    </div>
    
    <!-- chat list / window -->
    <div class="chat-window ">
      <ul class="chat-list list-group"></ul>
    </div>

    <!-- new chat form -->
    <div class="fixed-bottom w-50 m-auto text-center">
      <form class="new-chat my-3">
        <div class="input-group">
          <div class="input-group-prepend ur-msg">
            <div class="input-group-text ur-msg">Your message:</div>
          </div>
          <input type="text" id="message" class="form-control" required>
          <div class="input-group-append">
            <button type="submit" class="btn btn-lg">
              Send
            </button>
            <!-- <input type="submit" class="btn btn-lg" value="send"> -->
          </div>
        </div>
      </form>
    </div>

    <!-- <div class="fixed-bottom w-50 m-auto text-center">
       <form class="new-name mb-3 float-right">
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text">Update name:</div>
          </div>
          <input type="text" id="name" class="form-control" required>
          <div class="input-group-append">
            <input type="submit" class="btn" value="update">
          </div>
        </div>
        <div class="update-mssg text-center my-2"></div>
      </form>
    </div> -->
    <p class="username" style="display: none;"></p>

  </div>
  
  <script src="scripts/date_fns.js"></script>

  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
  <script src="scripts/google-auth.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
  <script defer>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyDzhVaWjRm1RcK7Do6axiBEZmcGahv4AqM",
      authDomain: "iws-chat.firebaseapp.com",
      databaseURL: "https://iws-chat.firebaseio.com",
      projectId: "iws-chat",
      storageBucket: "iws-chat.appspot.com",
      messagingSenderId: "407800149726",
      appId: "1:407800149726:web:e716d0ae483acec79ab44f"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    var provider = new firebase.auth.GoogleAuthProvider();

    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        // User is signed in.
        console.log("User signed in");
        console.log(user);
        const userp = document.querySelector('.username');
        userp.innerHTML = user['displayName'];
        // console.log(userp.innerHTML);
      } else {
        // No user is signed in.
        firebase.auth().signInWithRedirect(provider);
        firebase.auth().getRedirectResult().then(function(result) {
          if (result.credential) {
            // This gives you a Google Access Token. You can use it to access the Google API.
            var token = result.credential.accessToken;
            // ...
          }
          // The signed-in user info.
          var user = result.user;
          console.log("User signed in");
          console.log(user);
          const userp = document.querySelector('.username');
          userp.innerHTML = user['displayName'];
          // console.log(userp.innerHTML);
        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;
          // ...
        });
      }
    });
    
  </script>

  <script src="scripts/chat.js"></script>
  <script src="scripts/ui.js"></script>
  <script defer src="scripts/app.js"></script>
</body>
</html>